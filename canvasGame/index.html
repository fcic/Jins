<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Jins Game</title>
</head>
<body>
	<h1>Fork me on : https://github.com/rockjins/Jins</h1>
<script type="text/javascript">
console.log("*作者：周震\n*时间：2016-05-30\n*QQ：1300327885");
	//创建画布
	var canvas = document.createElement("canvas");
	var ctx = canvas.getContext("2d");
	canvas.width = 512;
	canvas.height = 480;
	document.body.appendChild(canvas);
	//加载背景图
	var bgReady = false;
	var bgImage = new Image();
	bgImage.onload = function(){
		bgReady = true;
	}
	bgImage.src="images/background.png";
	//加载英雄图片
	var heroReady = false;
	var heroImage = new Image();
	heroImage.onload =function(){
		heroReady = true;
	}
	heroImage.src="images/hero.png";
	//加载怪物图片
	var monsterReady = false;
	var monsterImage = new Image();
	monsterImage.onload =function(){
		monsterReady = true;
	}
	monsterImage.src="images/monster.png";
	//定义对象
	var hero = {
		speed:256,
		x:0,
		y:0
	}
	var monster = {
		x:0,
		y:0
	}
	var monsterCaught = 0;
	//处理玩家输入
	var keysDown = {};
	addEventListener("keydown",function(e){
		keysDown[e.keyCode] = true;
	},false);
	addEventListener("keyup",function(e){
		delete keysDown[e.keyCode];
	},false);
	//新游戏
	//英雄的初始位置
	var reset = function(){
		hero.x = canvas.width/2;
		hero.y = canvas.height/2;
	//怪物的初始随机位置
		monster.x = 32 + (Math.random() * (canvas.width - 64));
		monster.y = 32 + (Math.random() * (canvas.height - 64))
	}
	//更新对象
	var update = function(modifier){
		if (38 in keysDown) {
			hero.y -= hero.speed*modifier;
		}
		if (40 in keysDown) {
			hero.y += hero.speed*modifier;
		}
		if (37 in keysDown) {
			hero.x -= hero.speed*modifier;
		}
		if (39 in keysDown) {
			hero.x += hero.speed*modifier;
		}
		//如果英雄和怪物碰撞
		if (hero.x <= (monster.x + 32)  
            && monster.x <= (hero.x + 32)  
            && hero.y <= (monster.y + 32)  
            && monster.y <= (hero.y + 32)
            ) {
			++monsterCaught;
			reset();
		}
	}
	//渲染对象
	var render = function(){
		if(bgReady){
			ctx.drawImage(bgImage,0,0);
		}
		if(heroReady){
			ctx.drawImage(heroImage,hero.x,hero.y);
		}
		if(monsterReady){
			ctx.drawImage(monsterImage,monster.x,monster.y);
		}
		//显示分数
		ctx.fillStyle = "rgb(255,255,255)"
		ctx.font = "24px Helvetica";
		ctx.textAlign = "left";
		ctx.textBaseline = "top";
		ctx.fillText("捕获的怪物：" + monsterCaught + "只",32,32);
	}
	//游戏主循环
	var main = function(){
		var now = Date.now();
		var delta = now - then;
		update(delta/1000);
		render();
		then=now;
	}
	//开始游戏
	reset();
	var then = Date.now();
	setInterval(main,1);
</script>
</body>
</html>
